Guía rápida: Servicios con horarios y estado
===========================================
Objetivo
- Administrar el catálogo de servicios (spa, limpieza, tours) con horarios opcionales, precios y estado, usando exclusivamente procedimientos Oracle.

Procedimientos disponibles (ya implementados)
- JRGY_PRO_SERVICIO_LISTAR(p_include_inactive, cur OUT)
  * p_include_inactive=1 para admins; 0 para público.
- JRGY_PRO_SERVICIO_OBTENER(p_id, cur_serv OUT, cur_hor OUT): devuelve servicio y horarios.
- JRGY_PRO_SERVICIO_CREAR(p_nombre, p_descripcion, p_precio, p_tipo, p_estado, p_destacado, p_orden, p_horarios_json, p_id OUT)
  * p_horarios_json: JSON [{"inicio":12,"fin":15}, ...]; valida 0–23 y fin>=inicio; error -20081 horarios inválidos.
- JRGY_PRO_SERVICIO_ACTUALIZAR(p_id, ... mismos campos ..., p_horarios_json)
  * Errores: -20081 horarios inválidos; -20082 no encontrado.
- JRGY_PRO_SERVICIO_CAMBIAR_ESTADO(p_id, p_estado)
  * Estado: activo/inactivo; error -20082 no encontrado.
- JRGY_PRO_SERVICIO_ELIMINAR(p_id)
  * Baja lógica (estado inactivo); error -20083 no encontrado.
- JRGY_PRO_SERVICIO_BORRAR(p_id)
  * Borra horarios/servicio; error -20098 si tiene reservas asociadas; -20082 no encontrado.
- JRGY_PRO_SERVICIO_HORARIOS_LISTAR(cur OUT): lista horarios de todos los servicios (para componer respuestas).
- Reservas y servicios de reserva usan otros procs (ver memoria_ia.txt) para validar fecha/hora dentro de reserva y estado activo.

Backend (Node) - pautas
- Rutas `/api/services` usan solo estos procs (ver backend/src/routes/services.js).
- Validar token y rol ADMIN en crear/editar/cambiar estado/borrar; GET es público y opcionalmente incluye inactivos si admin.
- Mapear errores Oracle a HTTP: 400 datos inválidos, 404 no encontrado, 409 conflicto (p.ej. reservas vinculadas).
- Validación previa: horarios deben ser horas completas (minutos 00) entre 0–23 y fin>=inicio; rechazar minutos mientras los procs no soportan decimales.

Frontend (Admin)
- Página `/admin/services`: formulario con nombre/descr./tipo/precio/estado/destacado/orden y horarios; listado con filtros por nombre/tipo/precio/hora, acciones Editar / Activar-Inactivar / Eliminar.
- Inputs de horario restringidos a HH:00 (step 1h) y muestran error si se ingresan minutos ≠ 00 para alinearse con los procs actuales.
- Solo ADMIN puede ejecutar acciones; EMPLOYEE/USER no acceden al CRUD admin.

Frontend (Employee)
- Vista `/employee/services`: lista servicios activos con filtros básicos (buscar, tipo, hora) y muestra horarios/flags destacados.
- Si el rol es EMPLOYEE se filtran servicios/productos a las categorías permitidas (ej. HOUSEKEEPING, ROOM SERVICE, MANTENCION, SPA) y solo puede CRUDear dentro de esas categorías.

Experiencia cliente (web pública y reservas)
- Catálogo público muestra solo servicios con ESTADO=ACTIVO, ordenados por ORDEN y DESTACADO primero.
- Filtros disponibles: búsqueda, categoría/tipo (misma lista que admin/inventario) y hora (si el servicio tiene horarios). Horarios vacíos = disponible siempre.
- Al agregar a una reserva, el backend valida con los procs de reserva-servicio: fecha dentro de la reserva, servicio activo, hora dentro del rango. Si falla, se responde con mensaje de validación claro.
- Estados visibles en tickets del cliente: Creado → En cola → En ejecución → Listo (sin exponer estados internos de empleados).
- Nueva idea: el cliente no elige productos ni compone; selecciona un paquete armado (tratamos cada paquete como un “servicio” con sus productos asociados). Los empleados/admin arman el paquete usando `/services/:id/products`. En UI cliente solo se muestra nombre/descr./precio/horarios; en backend se mantiene la asociación servicio-producto para que el empleado sepa qué insumos requiere el paquete.

Experiencia empleado (tablero y vista /employee/services)
- Pueden consultar servicios activos (y opcionalmente inactivos si se habilita en backend) con filtros rápidos de nombre/tipo/hora.
- En el tablero de peticiones, gestionan tickets de servicios de reserva con flujo Pendiente/Nuevo → En ejecución → Finalizado; el cambio de estado se refleja en la vista del cliente.
- Pueden ver productos asociados al servicio para preparar insumos (ruta `/services/:id/products`), sin modificar el catálogo de servicios salvo rol ADMIN.

Roles y permisos
- ADMIN: CRUD completo, horarios, estado, eliminación (con restricciones de reservas).
- EMPLOYEE: lectura y CRUD solo dentro de sus categorías asignadas; el resto no se muestra en la UI de empleado.
- USER: ve servicios activos en la web pública y puede añadir a su reserva vía flujos de reserva (validado por procs de reserva-servicio).

Servicios solicitados por clientes (tickets de reserva)
- Los servicios asociados a una reserva permiten que el cliente solicite “tickets” que el empleado ve en el tablero de peticiones.
- Flujo empleado: Pendiente/Nuevo → En ejecución → Finalizado. Flujo visible para el cliente: Creado → En cola → En ejecución → Listo.
- Los tickets se alimentan de `/reservations/:id/services` y muestran a qué reserva/habitación/cliente pertenecen.
- Cada servicio puede traer productos asociados (ruta `/services/:id/products`). Un ticket indica cuántos productos requiere; la categoría del servicio (TIPO: spa, exterior, etc.) ayuda a clasificar insumos.
- Los empleados pueden reasignar/actualizar estado; el cliente ve el cambio de estado para saber si su servicio está en cola o ejecutándose.

Notas
- Orden controla prioridad visual: números bajos aparecen primero.
- Destacado es un flag (Y/N) para destacar en UI pública.
- Horarios vacíos => servicio disponible a cualquier hora (validación en procs de reserva-servicio).
